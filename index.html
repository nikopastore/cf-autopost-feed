<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Career Forge ‚Äî Ops & Analytics Hub</title>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <style>
    :root { --bg:#0b0c10; --card:#111318; --muted:#9aa4af; --fg:#e5e7eb; --border:#1c1f26; }
    *{ box-sizing:border-box }
    body{ margin:0; font:14px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial; background:var(--bg); color:var(--fg); }
    header{ padding:28px 18px; border-bottom:1px solid #222; position:sticky; top:0; background:linear-gradient(180deg,rgba(11,12,16,.96),rgba(11,12,16,.78)); backdrop-filter: blur(4px); z-index:9;}
    h1{ margin:0 0 6px; font-size:22px }
    .sub{ color:var(--muted); font-size:12px }
    main{ max-width:1100px; margin:18px auto 60px; padding:0 16px }
    .grid{ display:grid; gap:16px }
    .cards{ grid-template-columns:repeat(auto-fit,minmax(240px,1fr)) }
    .card{ background:var(--card); border:1px solid var(--border); border-radius:14px; padding:16px }
    .card h3{ margin:0 0 8px; font-size:14px; color:#cbd5e1 }
    .kpi{ font-size:22px; font-weight:700 }
    .muted{ color:var(--muted) }
    .btnrow{ display:flex; flex-wrap:wrap; gap:10px; margin-top:10px }
    .btn{ display:inline-block; padding:10px 14px; border-radius:10px; border:1px solid var(--border); background:#0f1218; color:#cfe1ff; text-decoration:none; font-weight:600 }
    .btn:hover{ background:#121723 }
    .btn.disabled{ opacity:.5; pointer-events:none }
    h2.section{ margin:26px 0 10px; font-size:16px }
    ul.links{ list-style:none; padding:0; margin:0 }
    ul.links li{ padding:10px 0; border-bottom:1px solid var(--border); display:flex; justify-content:space-between; align-items:center; gap:10px; flex-wrap:wrap }
    ul.links a{ color:#93c5fd; text-decoration:none; font-weight:600 }
    ul.links a:hover{ text-decoration:underline }
    .pill{ display:inline-block; padding:2px 8px; border-radius:999px; font-size:11px; background:#1c2430; color:#cfe1ff; }
    .small{ font-size:12px }
    .warn{ color:#fbbf24; font-size:12px; margin-top:6px }
  </style>
</head>
<body>
  <header>
    <h1>Career Forge ‚Äî Ops & Analytics Hub</h1>
    <div class="sub">Automated posts + live analytics (GitHub Actions & static files)</div>
  </header>
  <main>
    <div class="grid cards">
      <div class="card">
        <h3>üìä Total Posts</h3>
        <div id="kpi-total" class="kpi">‚Äî</div>
        <div id="kpi-updated" class="small muted">Last updated ‚Äî</div>
        <div class="btnrow">
          <a class="btn" href="analytics/dashboard.html">Open Dashboard</a>
          <a class="btn" href="analytics/latest_report.md">Latest Report (MD)</a>
        </div>
      </div>

      <div class="card">
        <h3>‚öôÔ∏è Generators & Feeds</h3>
        <div class="btnrow">
          <a class="btn" href="build_rss.py">build_rss.py</a>
          <a class="btn" href="scripts/make_x_feed.py">make_x_feed.py</a>
        </div>
        <div class="btnrow">
          <a class="btn" href="rss.xml">rss.xml</a>
          <a class="btn" href="rss_x.xml">rss_x.xml</a>
          <a class="btn" href="rss_x_live.xml"><span class="pill">LIVE</span> rss_x_live.xml</a>
        </div>
        <div class="small muted" style="margin-top:8px">Point your X Zap at <strong>rss_x_live.xml</strong> for a 1-item feed.</div>
      </div>

      <div class="card">
        <h3>üîó Integrations</h3>
        <div class="btnrow">
          <a id="zapier-dashboard" class="btn disabled" href="#" target="_blank" rel="noopener">Open Zapier Dashboard</a>
          <a id="buffer-dashboard" class="btn disabled" href="#" target="_blank" rel="noopener">Open Buffer Dashboard</a>
        </div>
        <div id="link-warning" class="warn">Set both links in the CONFIG block at the bottom of this page.</div>
      </div>

      <div class="card">
        <h3>üóÇÔ∏è Raw Data</h3>
        <div class="btnrow">
          <a class="btn" href="analytics/posts_features.csv">posts_features.csv</a>
          <a class="btn" href="analytics/feature_summary.csv">feature_summary.csv</a>
          <a class="btn" href="analytics/for_chatgpt.md">brief for ChatGPT</a>
        </div>
      </div>
    </div>

    <h2 class="section">Quick Links</h2>
    <ul class="links">
      <li>
        <div>üîÅ Post workflow <span class="pill">.github/workflows/post.yml</span></div>
        <a href="https://github.com/">Open Actions</a>
      </li>
      <li>
        <div>üìà Analytics workflow <span class="pill">.github/workflows/analytics.yml</span></div>
        <a href="https://github.com/">Open Actions</a>
      </li>
      <li>
        <div>üß† Seeds <span class="pill">content/seeds_topics.txt</span></div>
        <a href="content/seeds_topics.txt">View</a>
      </li>
      <li>
        <div>‚ö° Zapier Dashboard</div>
        <a id="ql-zapier" class="btn disabled" href="#" target="_blank" rel="noopener">Open</a>
      </li>
      <li>
        <div>üì¶ Buffer Dashboard</div>
        <a id="ql-buffer" class="btn disabled" href="#" target="_blank" rel="noopener">Open</a>
      </li>
    </ul>
  </main>

<script>
(async function(){
  const bust='?t='+Date.now();
  async function parseCSV(url){
    return new Promise((resolve,reject)=>{
      Papa.parse(url, { download:true, header:true, skipEmptyLines:true,
        complete: res=>resolve(res.data), error: err=>reject(err)
      });
    });
  }
  try{
    const posts = await parseCSV('analytics/posts_features.csv'+bust);
    document.getElementById('kpi-total').textContent = posts.length.toString();
    const dt = posts.map(r=>r.pubDate_local).filter(Boolean).sort().pop();
    document.getElementById('kpi-updated').textContent = dt ? ('Last updated ' + new Date(dt).toLocaleString()) : 'Last updated ‚Äî';
  }catch(e){
    console.warn('Analytics files not ready yet.', e);
  }

  // ---- CONFIG: paste your real dashboards here (include https://) ----
  const LINKS = {
    zapier: "https://zapier.com/app/zaps",            // EXAMPLE
    buffer: "https://publish.buffer.com/"             // EXAMPLE
  };
  // --------------------------------------------------------------------

  // Apply links; if missing, keep buttons visible but disabled with a hint
  function setLink(id, url){
    const el = document.getElementById(id);
    if(!el) return;
    if(url && /^https?:\/\//.test(url) && !url.includes('<YOUR_')){
      el.href = url;
      el.classList.remove('disabled');
    } else {
      el.href = '#';
      el.classList.add('disabled');
    }
  }
  setLink('zapier-dashboard', LINKS.zapier);
  setLink('buffer-dashboard', LINKS.buffer);
  setLink('ql-zapier', LINKS.zapier);
  setLink('ql-buffer', LINKS.buffer);

  // Hide the yellow warning if both links are set
  const bothSet = ['zapier','buffer'].every(k => /^https?:\/\//.test(LINKS[k]) && !LINKS[k].includes('<YOUR_'));
  if(bothSet) {
    const warn = document.getElementById('link-warning');
    if(warn) warn.style.display = 'none';
  }
})();
</script>
</body>
</html>
